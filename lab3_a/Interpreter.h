#pragma once
#include <iostream>
#include <string>
#include <vector>
#include <fstream>
#include <regex>
#include <stack>

#include "Calculator/ST_Calculator.h"
#include "Function.h"
#include "Variables/Variable.h"
#include "Variables/String.h"
#include "Variables/Array.h"


class Interpreter
{
public:
	/*
	* Работа интерпретатора состоит в исполнении двух функций: 
	* take_func (собирает информацию о функциях) и
	* perform_body (выполняет код внутри функций)
	*/
	Interpreter(std::string robocode_file, std::string labyrinth_file);

private:
	//В этом стеке находится номер позиции в коде, к которой необходимо вернуться в случае встречи return, finish или начала программы
	std::stack<int> pos_stack;
	//В этом стеке хранятся контексты вызываемых функций
	std::stack<Function*> context_stack;

	std::vector<std::string> code;
	std::map<std::string, Function*> functions;
	

	

	void take_funcs();
	void perform_body();
};